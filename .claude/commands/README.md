# Claude Code 数据增强智能助手

这个自定义命令创建了一个智能AI助手，能够在执行任务时自动识别需要数据库支持的部分，先查询相关数据，然后基于数据上下文完成您的任务。**无需任何配置文件，自动发现项目数据库设置！**

## 安装

只需要一个文件：
- **主命令**: `.claude/commands/ask-with-data.md`

该命令会自动检测项目中的数据库配置，支持多种配置文件格式和项目类型。

## 使用方法

在Claude Code中使用斜杠命令：

```
/ask-with-data <您的问题或任务>
```

### 示例用法

```bash
# 基于数据的分析和优化
/ask-with-data 帮我基于当前用户数据优化用户注册流程

# 创建数据驱动的功能
/ask-with-data 创建一个显示最受欢迎API渠道的仪表板

# 问题诊断和修复
/ask-with-data 修复高使用量用户的计费问题

# 数据分析和报告
/ask-with-data 分析为什么错误率上升并提出改进建议

# 业务洞察
/ask-with-data 写一份关于我们顶级客户及其使用模式的报告

# 性能优化
/ask-with-data 帮我了解哪些模型性能不佳

# 代码改进建议
/ask-with-data 基于实际使用数据建议如何优化API性能
```

## 功能特性

### 1. 自动配置发现
命令会自动检测项目中的数据库配置：

- **配置文件**: config.yaml, config.json, .env, application.properties
- **项目类型**: Go, Spring Boot, Node.js等
- **数据库文件**: 自动查找SQLite数据库文件

### 2. 智能任务分析
自动分析您的任务，识别需要数据库支持的部分：

- **用户相关任务**: 涉及用户注册、管理、分析的任务
- **渠道优化**: API渠道性能分析和优化建议  
- **使用统计分析**: 流量分析、使用模式识别
- **错误诊断**: 问题分析、故障排查、性能优化
- **业务洞察**: 客户分析、收入优化、趋势预测
- **模型性能**: AI模型效果分析和优化建议

### 3. 数据驱动决策

基于实际数据提供：

- **准确的分析**: 基于真实数据而非假设
- **个性化建议**: 针对您项目的具体情况
- **可行的解决方案**: 结合代码和数据的实用建议
- **量化的洞察**: 具体的数字和趋势分析

### 4. 全栈任务支持
- 数据分析 + 代码实现
- 问题诊断 + 解决方案
- 性能分析 + 优化建议
- 业务洞察 + 功能开发

## 扩展和自定义

### 添加新的数据类型支持

直接编辑 `.claude/commands/ask-with-data.md` 文件中的分析逻辑：

```bash
# 添加新的任务类型检测
if [[ $QUESTION_LOWER =~ (your|task|keywords) ]]; then \
    echo "🔍 Detected your custom task type" && QUERIES_TO_RUN="$QUERIES_TO_RUN your_query"; \
fi

# 添加对应的数据查询
"your_query") \
    if [ -f "$DB_CONNECTION" ]; then \
        sqlite3 "$DB_CONNECTION" "YOUR SQL QUERY HERE;" 2>/dev/null || echo "❌ Query failed"; \
    else echo "❌ Database not found"; fi ;;
```

## 故障排除

### 1. 数据库未找到
- 确保SQLite数据库文件存在
- 检查数据库文件路径
- 确认项目结构

### 2. 任务执行失败
- 验证数据库表结构
- 检查SQL语法
- 确认数据库权限
- 检查任务描述是否清晰

## 工作流程

```
用户任务 → Claude Code → /ask-with-data 命令 → 
分析任务需求 → 自动发现数据库 → 查询相关数据 → 
基于数据上下文执行任务 → 提供完整解决方案
```

该命令设计为智能助手，能够将数据洞察与代码实现完美结合，适用于任何需要数据支持的开发任务。